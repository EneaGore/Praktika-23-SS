 <!DOCTYPE html>
<html>
  <head>
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script> 
 <link rel="stylesheet" href = "../stylesheets/wait_style.css">

   <meta charset="utf-8" />
    <title>COCK</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        background-color: #fff;
      }
 @keyframes example{
  0% {background-color: #118A9E;}
  25%  {background-color: #B743F9;}
  50%  {background-color: blue;}
  75% {background-color: pink;}
} 


.cock {
background-color: red;
animation-name: example;
animation-duration: 5s ;
animation-iteration-count: infinite;
animation-timing-function: linear;
}
	
html {
overflow: scroll;
}
  </style>
  </head>
<body> 
<div class="topnav">
  <a id = "con" class="active" onclick="do_drink()">Confirm Order</a>

<a  onclick="clear_drink()"> Clear Selection</a>
<a onclick="load_home()"> Recomender </a>
<a href ="../server/voice_assist.php"> Hands_free </a> 
<a onclick="get_order()"> show order  </a> 
<a onclick="focus_btn()"> focus </a>
<a onclick ="say_something()"> listen </a>
<a onclick="record_talk()"> record </a>
<a onclick ="open_gpt3()"> gpt-3 bartender </a>
<a href = "wait.html" > PC version</a>
</div>


<div align = "center" >
<div id ="nav2" class="topnav_2">
</div>
</div>
<script>

console.log("test");

const cocks = ["gin_tonic","tequila_sunrise", "white_russian", "old_fashioned", "mojito", "cuba_libre","capi", "flying_hirsch", "long_island", "bloody_mary"];

var cock_button = "";
for(const cock of cocks) {
console.log(cock);
   cock_button += "<a  id=" + cock+  ' onclick=set_one('+  '"' + cock + '"' +')>' + cock + " </a>" 
}
document.getElementById("nav2").innerHTML = cock_button;
</script>



<div  class="column_mobile">
	<h2 align = "center"> Alchools </h2>	
<div id = "col1"  align = "center" class = "number">
</div>

</div>
<div class="column_mobile">
	<h2 align ="center" > Mixers </h2>	

<div id ="col2" align = "center" class = "number">
</div>
</div>


<div  class="column_modile">
	<h2 align = "center"> Garnish </h2>	
<div id = "col3" align ="center" class = "number"> 
</div>
</div>

<script>
let person = prompt(" Please give a name be unique or u might fuck the application", "Mentally challenged Panda");
var isChrome = !!window.chrome;
if(isChrome == true){
	// alert("Chrome user, ky$, go to firefox");
}

var callback = "absolutelty fucking nothing";
const sse = new  EventSource("../server/event.php");
sse.addEventListener("callback_change", (e) => {
console.log("was " + callback);
console.log("new " + e.data);
callback = e.data;
});

function build_drink_div(id){
	return  "<h3 id=" + '"' + id + '_name"' + " class = drinky >" +id + "</h3>" 
		+ '<span onclick= dec('+'"'+ id+ '"'  +")"+" class=minus>-</span>"
		+ "<input id=" + '"' +id+'"' + 'type="text" value="0"/>'+
        "<span onclick=inc(" + '"' + id + '"' + ') class=plus>+</span>' + "<br>"
}

var garnish  = ["tabasco", "lemon", "ice", "grenadine", "mint","salt",  "sugar","heavy_cream","bitter"];
var mixers  = ["cola","tonic","sprudel","redbull","orange_juice","sprite", "cocunt_milk", "seamen", "tomato_juice"];
var alcs  = ["gin", "vodka", "tequila", "whiskey","jager_meister","kahlua", "white_rum", "dark_rum","triple-sec", "aperol"];
var col3_str ="";
var col1_str = "";
var col2_str = "";
for(const id  of garnish){
	col3_str += build_drink_div(id); 
}
for(const id  of mixers){ 	col2_str += build_drink_div(id); }
for(const id  of alcs){	        col1_str += build_drink_div(id); }

document.getElementById("col1").innerHTML = col1_str ;
document.getElementById("col2").innerHTML = col2_str ;
document.getElementById("col3").innerHTML = col3_str ;



//list of drinks
// negroni, tequila sunrise, capi, old fashioned, mojito, bloody mary, moscow mule

// XXX Variables  XXX 
let sum = 0
function getQSVar( varname ) { 
   var query = window.location.search.substring( 1 ); 
   var vars = query.split( "&" );
   var len = vars.length; 
   for ( var i = 0; i < len; i++ ) { 
      var pair = vars[ i ].split( "=" ); 
      if ( pair[ 0 ] == varname ) { 
         return pair[ 1 ]; 
      } 
   } 
   return null;
}
var col  = getQSVar( 'cock' ); // 10
console.log(col);
var recipes = {
"gin_tonic" : ["gin", "tonic", "lemon","ice"],
"cuba_libre" : ["dark_rum", "cola", "lemon", "ice"],
"capi" : ["white_rum", "lemon","ice", "sugar" ],
"old_fashioned" : ["whiskey","bitter", "sugar" ],
"mojito": ["white_rum","mint", "ice", "sugar", "sprudel"],
"tequila_sunrise": ["tequila", "orange_juice", "ice", "grenadine"],
"flying_hirsch" : ["redbull", "jager_meister" ,"ice"],
"white_russian" : ["vodka", "kahlua", "heavy_cream"],
"long_island" :["vodka","gin","tequila","triple-sec", "cola", "lemon", "ice"],
"bloody_mary" :["vodka","tomato_juice", "lemon","salt","tabasco"],
};

ingred = ["gin","redbull", "tabasco","kahlua", "heavy_cream","salt","tomato_juice", "triple-sec", "jager_meister","bitter", "vodka", "tequila", "whiskey", "white_rum", "dark_rum", "aperol","lemon", "ice", "grenadine", "mint", "sugar","cola","tonic","sprudel","orange_juice","sprite", "cocunt_milk", "seamen"];
function focus_btn(){

for(const [key,value]  of Object.entries(recipes)){
console.log(key);
highlight(key);
}
}
var wait = (ms) => {
    const start = Date.now();
    let now = start;
    while (now - start < ms) {
      now = Date.now();
    }
}
function highlight(key){
document.getElementById(key).style.outline ="#f00 solid 2px";

}



function open_gpt3(){
window.location = "../server/my_gpt3.php";
}
// https://www.deutsches-fasd-kompetenzzentrum-bayern.de/
//putCallback(url);
function do_drink(){
	document.getElementById("con").disabled = true;
	console.log("cooock");
	let uniq = person ; // XXX 
	// for better add an actual unique id
	let order = get_order();
	console.log(order)
	var order_join = "" 
	
	$.ajax({
url :"../server/save_order.php",
	
	data: {
	id: uniq,
	order :  order.toString() 
	},
	success: function(result){
	}
});
 	 
fetch(
		callback,{
		method: "PUT",
		headers:{
		"Content-Type":"application/json"
},
	body: JSON.stringify({id:uniq, ord:order.toString() })
}).then(response => 
{	
if(response.status  == 200){	window.location = "../server/preping.php?id="+uniq+"&order="+order.toString()}
else{ alert("Please try again, your callback has been refreshed");}
}
);
/*
	.then(response => response.json())
	.then(response => {
console.log(response);
console.log(response.status);
 */

//}
// );

}


function say_something(){
const synth = speechSynthesis;
synth.cancel()
utter = new SpeechSynthesisUtterance("I am a human");
utter.rate = 1
// window.speechSynthesis.cancel();
synth.speak(utter);
}

async function putCallback(url,iid,oorder){
return	await fetch(
		callback,{
		method: "PUT",
		headers:{
		"Content-Type":"application/json"
},
	body: JSON.stringify({id:iid, order:oorder })
}
) ;
}

function get_order(){
var order_arr = [];
for(const el_id of ingred){
	const doc_val = parseInt(document.getElementById(el_id).value,10);
	for(let i = 0; i <doc_val;i++){
		order_arr.push(el_id);
	}
}
return order_arr;
	// TODO a lot of stu
}

//get_order();
function clear_drink(){

for (const el of ingred) {
	document.getElementById(el).value = 0 ;
	document.getElementById(el+"_name").className = " drinky";
	}	
}


set_one(col);
function fix_drink(drink){
var rec_arr = recipes[drink];
for (const element of rec_arr){
	inc(element);
}
}

function set_one(drink) {
clear_drink();	
var rec_arr = recipes[drink];
for(const element of rec_arr){
	document.getElementById(element).value = 1;
	document.getElementById(element+"_name").className += " color_drinky";
}
}

// dont let the name drink fool you, its just one ingredient
function dec(drink){
//      let parentDom = document.getElementById('n1');
        let value =parseInt( document.getElementById(drink).value,10);
        new_val = value > 0 ? value -1 : value
		document.getElementById(drink).value = new_val;
	if(new_val == 0){
	
	document.getElementById(drink+"_name").className = " drinky";
	}

}

function inc(drink) {
	let value = parseInt(document.getElementById(drink).value,10);
	new_val = value + 1
	document.getElementById(drink).value = new_val;
	document.getElementById(drink+"_name").className += " color_drinky";
}

	

</script>
</div> 
</body>
</html>



